# ADR-001: Архитектура n8n-ai (тонкий форк + сайдкар)

Дата: 2025-08-29
Статус: Accepted

## Контекст
- Требуется AI-first UX с детерминизмом и безопасностью.
- n8n — основная платформа исполнения. Расширение через тонкий форк с хуками.

## Решение
- Тонкий форк n8n с API: Introspect, Graph Mutation, Validate/Simulate, Events.
- Сайдкар Orchestrator: SGR, агенты Planner/Builder/Validator/Critic, RAG, кэш схем.
- Общие схемы в `@n8n-ai/schemas` (Zod/JSONSchema). UI панель — отдельный пакет.

## Альтернативы
- Плагины вместо форка: ограничены текущими extension points апстрима.
- Монолит без сайдкара: хуже для изоляции и масштабирования.

## Последствия
- Минимизировать дельту форка, готовить PR в апстрим на extension points.
- Контракты и версионирование между компонентами обязательны.
